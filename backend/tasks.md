# 작업 목록 (prd.md 기반)

## 1. 사용자 모델
- [ ] 앱 최초 실행 시 `device_id(UUID)` 생성
- [ ] 서버에서 `device_id` 유일성 보장 및 관리 로직 구현
- [ ] 모든 서버 통신이 `device_id` 기준으로 동작하도록 API 계약 반영

## 2. 추천 기본 전략
- [ ] 외투 추천 전략 구현: 전날 동일 시각 대비 기온 변화 기반 판단
- [ ] 우산 추천 전략 구현: 출발 시각 강수 확률/강수량 절대값 기반 판단

## 3. 추천 생성 시점/스케줄러
- [ ] 사용자별 복수 출발 일정 저장 구조 설계
- [ ] 1분 주기 스케줄러 실행
- [ ] 현재 시점 기준 출발 10분 전 대상 일정 조회
- [ ] 대상 일정별 추천 생성 트리거

## 4. 추천 생성 파이프라인
- [ ] 출발 10분 전 대상 조회
- [ ] 오늘 출발 시각 기준 날씨 조회
- [ ] 전날 동일 시각 날씨 조회 (외투 계산용)
- [ ] 외투/우산 점수 계산
- [ ] 점수 임계치 비교 및 추천 판정
- [ ] 추천 메시지 생성
- [ ] 푸시 발송
- [ ] 추천 생성/발송 기록 저장

## 5. 점수 계산 규칙 구현
- [ ] 외투 점수 계산 구현
- [ ] `temp_diff = today_temp - yesterday_temp` 계산 반영
- [ ] 규칙 반영: `temp_diff <= -5 (+30)`, `temp_diff <= -8 (+20)`, `wind_speed >= 8 (+10)`
- [ ] 우산 점수 계산 구현
- [ ] 규칙 반영: `rain_probability >= 40 (+30)`, `rain_probability >= 60 (+50)`, `expected_rainfall_mm >= 5 (+30)`
- [ ] 추천 판정 구현: `coat_score >= 50`, `umbrella_score >= 50`
- [ ] 임계치 고정값 관리 방식 정의

## 6. 피드백 수집
- [ ] 추천 피드백 선택지 제공: 도움됨 / 별로였음
- [ ] 피드백 저장 스키마 구현: `device_id`, `recommendation_type`, `accepted`, `weather_snapshot`, `timestamp`
- [ ] 피드백 통계/분석 적재 경로 정의

## 7. 발송 및 일관성
- [ ] 출발 이벤트당 1회만 발송되도록 중복 방지 키 설계
- [ ] 추천 생성/발송 이력 저장
- [ ] 외부 연동 실패 오류 로깅
- [ ] 추천 추적 가능성 보장(감사/조회)

## 8. 구현 원칙 및 테스트
- [ ] 동일 입력에 동일 출력 보장(결정성)
- [ ] 추천 엔진 순수 함수 형태 설계
- [ ] 상태 의존 최소화(입력 기반 계산)
- [ ] 규칙 기반 단위 테스트 작성
- [ ] 파이프라인 통합 테스트 작성
- [ ] 스케줄러 시점(출발 10분 전) 테스트 작성
